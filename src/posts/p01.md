---
permalink: /post/p01/
layout: layouts/post.ejs
title: Minecraft and QQ group server interconnection tutorial
date: '2022-08-29'
tags:
  - Minecraft
  - Server
  - MCbot
published: false
hideInList: true
isTop: false
draft: true
---
Are you still envious of Discord and Telegram bots? Are you still annoyed that you need a VPN to use them? Now, a server-to-chat connection bot based on Forge and Fabric is here.
<!-- more -->

## 1\. Introduction

This mod is different from plugin-based server-to-chat connections, making it a good choice for server owners who don't want to deal with plugins.

-----

## 2\. Note

This mod has more than one tutorial. This one is for the **[Lagrange](https://www.google.com/search?q=https://link.mcmod.cn/target/aHR0cHM6Ly9naXRodWIuY29tL0xhZ3JhbmdlRGV2L0xhZ3JhbmdlLkNvcmU%3D)** protocol. If you are looking for a tutorial for another protocol, you can skip this one.

-----

## 3\. Preparation

  - A QQ account (a secondary account with low value is recommended)
  - The **[Lagrange version](https://github.com/LagrangeDev/Lagrange.Core/releases)** that is compatible with your device
  - The **[mod files](https://github.com/Nova-Committee/McBot/releases)** for your Minecraft version

**Expand version selection tips**

| Lagrange.Core Selection:                                     |
| ------------------------------------------------------------ |
| `x64`: Based on the `x86_64` architecture (i.e., common 64-bit `Intel` or `AMD` processors) |
| `arm64`: `ARM64` architecture                                |
| `arm`: 32-bit `ARM` architecture                             |
| **Normal Linux environment**: Choose a version that does not contain `musl` |
| **musl**: Linux system based on `musl` (e.g., Alpine Linux)  |

**Mod File Selection**

Please choose based on your mod loader and game version. A **Special Note: If the version from releases has a clear bug, it is likely not your fault. Please get the corrected version.**

-----

## 4\. Tutorial

### 1\. Configure Lagrange

| Windows                                    | Linux/macOS                                                  |
| ------------------------------------------ | ------------------------------------------------------------ |
| Double-click `Lagrange.OneBot.exe` to run. | Run the following commands: `chmod +x ./Lagrange.OneBot` and then `./Lagrange.OneBot` |

The first time you run it, a default `appsettings.json` configuration file will be automatically generated in the same directory. You need to correctly modify the file to set up Lagrange.

After modifying the configuration file as needed (using QR code login is recommended), press any key in the command line. Lagrange will officially run, and a login QR code image `qr-0.png` will appear in the same folder. Scan it with your mobile QQ as soon as possible before it expires.

**Expand configuration modification tips**

Please read the comments and highlighted content carefully.

```json
{
  "Logging": {
    "LogLevel": {
      "Default": "Information",  // Switch to Trace when reporting an Issue
      "Microsoft": "Warning",
      "Microsoft.Hosting.Lifetime": "Information",
    },
  },
  "SignServerUrl": "https://sign.lagrangecore.org/api/sign",
  "MusicSignServerUrl": "",
  "Account": {
    "Uin": 0,  // Fill in 0 for Uin to use QR code connection
    "Password": "",  // Do not fill in a password to use QR code connection
    "Protocol": "Linux", // Use Linux protocol
    "AutoReconnect": true,
    "GetOptimumServer": true,
  },
  "Message": {
    "IgnoreSelf": true, // Ignore the bot's own messages
    "StringPost": false,
  },
  "QrCode": {
    "ConsoleCompatibilityMode": false,
  },
  "Implementations": [  // Service implementations, multiple connections are supported
    {
      "Type": "ReverseWebSocket",
      "Host": "127.0.0.1",
      "Port": 8080,
      "Suffix": "/onebot/v11/ws",
      "ReconnectInterval": 5000,
      "HeartBeatInterval": 5000,
      "HeartBeatEnable": true,
      "AccessToken": "",
    },
    {
      "Type": "ForwardWebSocket",
      "Host": "127.0.0.1",
      "Port": 8081, // Set the port you have opened (both TCP and UDP protocols need to be open)
      "HeartBeatInterval": 5000,
      "HeartBeatEnable": true,
      "AccessToken": "",
    } // If your config file does not have this section, please add it manually
  ],
}
```

**Note:** Lines starting with `//` are comments. Be sure to delete them if you copy and paste them into the actual config file.

### 2\. Configure the mod

1.  First, move the mod file to your server's `mods` folder (running environment: ineffective on the client, required on the server).

2.  Start your server for the first time to let the mod generate its configuration file. Then shut down the server.

3.  Open the `mcbot` folder in the server's root directory, find the `config.toml` file, and open it.

4.  Check if the following items are correct (refer to the comments for others):

<!-- end list -->

  - `group-id-list = [12345,22344,66789]` **\# Supports multiple QQ groups, separated by a comma.**
  - `url = “ws://127.0.0.1:5140”` **\# Address and port number. Please ensure it matches your Lagrange settings.**
  - `bot-id = 100023` **\# Bot's QQ number.**

<!-- end list -->

5.  Restart the server and check if it is running correctly.

The following text indicates a successful launch: `[INFO] McBot: McBot is now running!`

-----

## 5\. Feedback

**If you have any questions or suggestions, please leave a message or contact me.**
